/*! campi-moduli-italiani 2.1.0 */
jQuery(document).ready(function(o){function a(){o.ajax({type:"post",dataType:"json",url:gcmi_fb_obj.ajax_url,data:{action:"gcmi_fb_get_filters",_ajax_nonce:gcmi_fb_obj.nonce},success:function(e){o("#gcmi-fb-filters-container").html(""),o("#gcmi-fb-filters-container").append(e.filters_html)}})}function t(){o("div[class^='gcmi-fb-lettera-blocco']").each(function(){var e=o(this);0===e.find("input[type=checkbox][id^='fb-gcmi-com-']:checked").length?e.hide():e.show()})}function l(e,i){var c=new jQuery.Deferred;return o("#gcmi-fb-dialog").html(e),o("#gcmi-fb-dialog").dialog({resizable:!1,height:240,modal:!0,title:i,buttons:{OK:function(){o(this).dialog("close"),c.resolve()},Cancel:function(){o(this).dialog("close"),c.reject()}}}),c.promise()}function r(e,i){var c=new jQuery.Deferred;return o("#gcmi-fb-dialog").html(e),o("#gcmi-fb-dialog").dialog({resizable:!1,height:240,modal:!0,title:i,buttons:{OK:function(){o(this).dialog("close"),c.resolve()}}}),c.promise()}function i(){o("button[id^='gcmi-fb-delete-filter-']").attr("disabled","disabled"),o("button[id^='gcmi-fb-edit-filter-']").attr("disabled","disabled"),o("#gcmi-fb-addnew-filter").attr("disabled","disabled")}function n(){o("#gcmi-fb-tabs-2").empty(),o("#gcmi-fb-tabs-3").empty(),o("#gcmi-fb-tabs-4").empty(),o("#gcmi-fb-tabs-5").empty()}function f(){var e="<span>In attesa dei dati...</span>";o("#gcmi-fb-tabs-2").append(e),o("#gcmi-fb-tabs-3").append(e),o("#gcmi-fb-tabs-4").append(e),o("#gcmi-fb-tabs-5").append(e)}function p(){var e=o("#gcmi-fb-include-ceased").prop("checked");o.ajax({type:"post",dataType:"json",url:gcmi_fb_obj.ajax_url,data:{action:"gcmi_fb_requery_comuni",_ajax_nonce:gcmi_fb_obj.nonce,includi:e},success:function(e){n(),o("#gcmi-fb-tabs-2").append(e.regioni_html),o("#gcmi-fb-tabs-3").append(e.province_html),o("#gcmi-fb-tabs-4").append(e.comuni_html),o("#gcmi-fb-tabs-5").append(e.commit_buttons)}})}function d(e){var i=o("#gcmi-fb-include-ceased").prop("checked");o.ajax({type:"post",dataType:"json",url:gcmi_fb_obj.ajax_url,async:!1,data:{action:"gcmi_fb_edit_filter",_ajax_nonce:gcmi_fb_obj.nonce,includi:i,filtername:e},success:function(e){n(),"true"===e.includi?o("input[type='checkbox'][id='gcmi-fb-include-ceased']").prop("checked",!0):o("input[type='checkbox'][id='gcmi-fb-include-ceased']").removeAttr("checked"),o("#gcmi-fb-tabs-2").append(e.regioni_html),o("#gcmi-fb-tabs-3").append(e.province_html),o("#gcmi-fb-tabs-4").append(e.comuni_html),o("#gcmi-fb-tabs-5").append(e.commit_buttons),o("#gcmi-fb-tabs-2 input[type=checkbox]:not(:checked)").not("[id^='fb-gcmi-chkall-']").each(function(){o(this).change()}),o("#gcmi-fb-tabs-3 input[type=checkbox]:not(:checked)").not("[id^='fb-gcmi-chkallpr-']").each(function(){o(this).change()})},error:function(e){console.log(e)}})}o("input[type=checkbox][id^='gcmi-']").prop("checked",!1),o("input[type=hidden][id^='gcmi-updated-']").each(function(e){"false"==o(this).val()&&(window.MySuffix=o(this).attr("id").substring("gcmi-updated-".length,o(this).attr("id").length),o("input[type=checkbox][id='gcmi-"+window.MySuffix+"']").prop("checked",!0))}),o("#gcmi-fb-tabs").hide(),o(document).on("click","#gcmi-fb-addnew-filter",function(){o("#gcmi-fb-tabs").show(),i(),n(),f(),o("input[type='checkbox'][id='gcmi-fb-include-ceased']").removeAttr("checked"),p()}),o(document).on("click","button[id^='gcmi-fb-edit-filter-']",function(){var e=o(this).attr("id").split("-").pop();o("#gcmi-fb-tabs").show(),i(),n(),f(),d(e)}),o(document).on("click","button[id^='gcmi-fb-delete-filter-']",function(){let e=o(this).attr("id").split("-").pop();var i='<span class="ui-icon ui-icon-alert" style="float:left; margin:12px 12px 20px 0;"></span><p>Vuoi davvero cancellare il filtro: <b>'+e+"</b>?</p>ATTENZIONE: Questa operazione non può controllare se il filtro è attualmente in uso nei tuoi moduli.";o.when(l(i,"Conferma eliminazione filtro")).then(function(){o.ajax({type:"post",dataType:"json",url:gcmi_fb_obj.ajax_url,data:{action:"gcmi_fb_delete_filter",_ajax_nonce:gcmi_fb_obj.nonce,filtername:e},success:function(e){a()},error:function(e){let i='<span class="ui-icon ui-icon-notice" style="float:left; margin:12px 12px 0 0;"></span>';var c=e.responseJSON.data;for(let e=0;e<c.length;e++)i=i+"<p><b>Err: "+c[e].code+"</b></p><p><i>"+c[e].message+"</i></p><p></p>";o.when(r(i,"Errore nella eliminazione del filtro")).then(function(){})}})})}),o(document).on("click","#gcmi-fb-button-cancel",function(){o.when(l('<span class="ui-icon ui-icon-alert" style="float:left; margin:12px 12px 20px 0;"></span>Vuoi annullare la creazione/modifica del filtro?',"Conferma annullamento operazione")).then(function(){o("#gcmi-fb-tabs").hide(),o("button[id^='gcmi-fb-delete-filter-']").removeAttr("disabled"),o("button[id^='gcmi-fb-edit-filter-']").removeAttr("disabled"),o("#gcmi-fb-addnew-filter").attr("disabled",!1)},function(){})}),o(document).on("click","#gcmi-fb-button-save",function(){event.preventDefault();var i,c,t,n=o("#gcmi-fb-tabs-4").find("input[type=checkbox]:checked").not("[id^='fb-gcmi-chkallcom-']").map(function(){return o(this).val()}).get();if(0===n.length)o.when(r('<span class="ui-icon ui-icon-notice" style="float:left; margin:12px 12px 20px 0;"></span>Non è stato selezionato nessun comune da includere nel filtro.',"Errore nel salvataggio")).then(function(){o("#ui-id-4").click()});else{let e=o("#fb_gcmi_filter_name").val();""===e?o.when(r('<span class="ui-icon ui-icon-notice" style="float:left; margin:12px 12px 20px 0;"></span>Non è stato indicato il nome del filtro.',"Errore nel salvataggio")).then(function(){o("#fb_gcmi_filter_name").focus()}):"unfiltered"===e?o.when(r('<span class="ui-icon ui-icon-notice" style="float:left; margin:12px 12px 20px 0;"></span>Nome del filtro non ammesso.',"Errore nel salvataggio")).then(function(){o("#fb_gcmi_filter_name").focus()}):20<e.length?o.when(l('<span class="ui-icon ui-icon-notice" style="float:left; margin:12px 12px 20px 0;"></span>Non più di 20 caratteri ammessi per il nome del filtro.',"Errore nel salvataggio")).then(function(){o("#fb_gcmi_filter_name").val(e.substring(0,20)),o("#fb_gcmi_filter_name").focus()}):(i=o("#gcmi-fb-include-ceased").prop("checked"),!1===(t=function(e){let i;{if("string"==typeof e||e instanceof String){if(0===e.length)return!1;i=e.trim();e=new RegExp(/[\x80-\xff]/g);return(i=(i=(i=(i=(i=e.test(i)?function(i){var c={"ª":"a","º":"o","À":"A","Á":"A","Â":"A","Ã":"A","Ä":"A","Å":"A","Æ":"AE","Ç":"C","È":"E","É":"E","Ê":"E","Ë":"E","Ì":"I","Í":"I","Î":"I","Ï":"I","Ð":"D","Ñ":"N","Ò":"O","Ó":"O","Ô":"O","Õ":"O","Ö":"O","Ù":"U","Ú":"U","Û":"U","Ü":"U","Ý":"Y","Þ":"TH","ß":"s","à":"a","á":"a","â":"a","ã":"a","ä":"a","å":"a","æ":"ae","ç":"c","è":"e","é":"e","ê":"e","ë":"e","ì":"i","í":"i","î":"i","ï":"i","ð":"d","ñ":"n","ò":"o","ó":"o","ô":"o","õ":"o","ö":"o","ø":"o","ù":"u","ú":"u","û":"u","ü":"u","ý":"y","þ":"th","ÿ":"y","Ø":"O","Ā":"A","ā":"a","Ă":"A","ă":"a","Ą":"A","ą":"a","Ć":"C","ć":"c","Ĉ":"C","ĉ":"c","Ċ":"C","ċ":"c","Č":"C","č":"c","Ď":"D","ď":"d","Đ":"D","đ":"d","Ē":"E","ē":"e","Ĕ":"E","ĕ":"e","Ė":"E","ė":"e","Ę":"E","ę":"e","Ě":"E","ě":"e","Ĝ":"G","ĝ":"g","Ğ":"G","ğ":"g","Ġ":"G","ġ":"g","Ģ":"G","ģ":"g","Ĥ":"H","ĥ":"h","Ħ":"H","ħ":"h","Ĩ":"I","ĩ":"i","Ī":"I","ī":"i","Ĭ":"I","ĭ":"i","Į":"I","į":"i","İ":"I","ı":"i","Ĳ":"IJ","ĳ":"ij","Ĵ":"J","ĵ":"j","Ķ":"K","ķ":"k","ĸ":"k","Ĺ":"L","ĺ":"l","Ļ":"L","ļ":"l","Ľ":"L","ľ":"l","Ŀ":"L","ŀ":"l","Ł":"L","ł":"l","Ń":"N","ń":"n","Ņ":"N","ņ":"n","Ň":"N","ň":"n","ŉ":"n","Ŋ":"N","ŋ":"n","Ō":"O","ō":"o","Ŏ":"O","ŏ":"o","Ő":"O","ő":"o","Œ":"OE","œ":"oe","Ŕ":"R","ŕ":"r","Ŗ":"R","ŗ":"r","Ř":"R","ř":"r","Ś":"S","ś":"s","Ŝ":"S","ŝ":"s","Ş":"S","ş":"s","Š":"S","š":"s","Ţ":"T","ţ":"t","Ť":"T","ť":"t","Ŧ":"T","ŧ":"t","Ũ":"U","ũ":"u","Ū":"U","ū":"u","Ŭ":"U","ŭ":"u","Ů":"U","ů":"u","Ű":"U","ű":"u","Ų":"U","ų":"u","Ŵ":"W","ŵ":"w","Ŷ":"Y","ŷ":"y","Ÿ":"Y","Ź":"Z","ź":"z","Ż":"Z","ż":"z","Ž":"Z","ž":"z","ſ":"s","Ə":"E","ǝ":"e","Ș":"S","ș":"s","Ț":"T","ț":"t","€":"E","£":"","Ơ":"O","ơ":"o","Ư":"U","ư":"u","Ầ":"A","ầ":"a","Ằ":"A","ằ":"a","Ề":"E","ề":"e","Ồ":"O","ồ":"o","Ờ":"O","ờ":"o","Ừ":"U","ừ":"u","Ỳ":"Y","ỳ":"y","Ả":"A","ả":"a","Ẩ":"A","ẩ":"a","Ẳ":"A","ẳ":"a","Ẻ":"E","ẻ":"e","Ể":"E","ể":"e","Ỉ":"I","ỉ":"i","Ỏ":"O","ỏ":"o","Ổ":"O","ổ":"o","Ở":"O","ở":"o","Ủ":"U","ủ":"u","Ử":"U","ử":"u","Ỷ":"Y","ỷ":"y","Ẫ":"A","ẫ":"a","Ẵ":"A","ẵ":"a","Ẽ":"E","ẽ":"e","Ễ":"E","ễ":"e","Ỗ":"O","ỗ":"o","Ỡ":"O","ỡ":"o","Ữ":"U","ữ":"u","Ỹ":"Y","ỹ":"y","Ấ":"A","ấ":"a","Ắ":"A","ắ":"a","Ế":"E","ế":"e","Ố":"O","ố":"o","Ớ":"O","ớ":"o","Ứ":"U","ứ":"u","Ạ":"A","ạ":"a","Ậ":"A","ậ":"a","Ặ":"A","ặ":"a","Ẹ":"E","ẹ":"e","Ệ":"E","ệ":"e","Ị":"I","ị":"i","Ọ":"O","ọ":"o","Ộ":"O","ộ":"o","Ợ":"O","ợ":"o","Ụ":"U","ụ":"u","Ự":"U","ự":"u","Ỵ":"Y","ỵ":"y","ɑ":"a","Ǖ":"U","ǖ":"u","Ǘ":"U","ǘ":"u","Ǎ":"A","ǎ":"a","Ǐ":"I","ǐ":"i","Ǒ":"O","ǒ":"o","Ǔ":"U","ǔ":"u","Ǚ":"U","ǚ":"u","Ǜ":"U","ǜ":"u"};var t;o.ajax({type:"post",dataType:"json",url:gcmi_fb_obj.ajax_url,async:!1,data:{action:"gcmi_fb_get_locale",_ajax_nonce:gcmi_fb_obj.nonce},success:function(e){t=e.locale},error:function(e){t="unknown"}}),t.startsWith("de")?(c["Ä"]="Ae",c["ä"]="ae",c["Ö"]="Oe",c["ö"]="oe",c["Ü"]="Ue",c["ü"]="ue",c["ß"]="ss"):"da_DK"===t?(c["Æ"]="Ae",c["æ"]="ae",c["Ø"]="Oe",c["ø"]="oe",c["Å"]="Aa",c["å"]="aa"):"ca"===t?c["l·l"]="ll":"sr_RS"!==t&&"bs_BA"!==t||(c["Đ"]="DJ",c["đ"]="dj");let n="";for(let e=0;e<i.length;e++)i.charAt(e)in c?n+=c[i.charAt(e)]:n+=i.charAt(e);return n}(i):i).toLowerCase()).replace("/[^a-z0-9_-]/","")).replace("-","_")).replace("__","_")).replace(/^_+/,"").replace(/_+$/,""),"unfiltered"===i?!1:0!==i.length&&i}return!1}}(e).substring(0,20))?o.when(r('<span class="ui-icon ui-icon-notice" style="float:left; margin:12px 12px 20px 0;"></span>Non è stato indicato un nome valido per il filtro.',"Errore nel salvataggio")).then(function(){o("#fb_gcmi_filter_name").focus()}):e!==t?(c='<span class="ui-icon ui-icon-notice" style="float:left; margin:12px 12px 20px 0;"></span>Il valore indicato per il nome del filtro:<b><i>'+e+"</i></b> non è utilizzabile.<br>Vuoi utilizzare: <b>"+t+"</b> ?",o.when(l(c,"Errore nel salvataggio")).then(function(){o("#fb_gcmi_filter_name").val(t)},function(){})):o.ajax({type:"post",dataType:"json",url:gcmi_fb_obj.ajax_url,data:{action:"gcmi_fb_create_filter",_ajax_nonce:gcmi_fb_obj.nonce,includi:i,filtername:t,codici:n},success:function(e){a(),o("#gcmi-fb-tabs").hide()},error:function(e){let i='<span class="ui-icon ui-icon-notice" style="float:left; margin:12px 12px 0 0;"></span>';var c=e.responseJSON.data;for(let e=0;e<c.length;e++)i=i+"<p><b>Err: "+c[e].code+"</b></p><p><i>"+c[e].message+"</i></p><p></p>";o.when(r(i,"Errore nella creazione del filtro")).then(function(){o("#fb_gcmi_filter_name").focus()})}}))}}),o("#gcmi-fb-tabs").tabs({active:!1,collapsible:!0,classes:{"ui-tabs":"ui-corner-none","ui-tabs-nav":"ui-corner-none","ui-tabs-tab":"ui-corner-none","ui-tabs-panel":"ui-corner-none"}}),o(document).on("change","input[type='checkbox'][id^='fb-gcmi-reg-']",function(){var e=o(this),i=o(this).attr("id").split("-").pop();!1===e.prop("checked")?(o("#gcmi-fb-regione-blocco-"+i).find('input[type=checkbox][id^="fb-gcmi-prov-"]:checked').removeAttr("checked"),o("#gcmi-fb-regione-blocco-"+i).find('input[type=checkbox][id^="fb-gcmi-prov-"]').trigger("change"),o("#gcmi-fb-regione-blocco-"+i).hide()):(o("#gcmi-fb-regione-blocco-"+i).find('input[type=checkbox][id^="fb-gcmi-prov-"]:not(:checked)').prop("checked",!0),o("#gcmi-fb-regione-blocco-"+i).find('input[type=checkbox][id^="fb-gcmi-prov-"]').trigger("change"),o("#gcmi-fb-regione-blocco-"+i).show())}),o(document).on("change","input[type='checkbox'][id^='fb-gcmi-prov-']",function(){var e=o(this),i=o(this).attr("id").split("-").pop(),c=o(this).parent().attr("class").split("-").pop();!1===e.prop("checked")?(o("[id='fb-gcmi-chkallpr-"+c).removeAttr("checked"),o("[name^='gcmi-com-cod-pro-"+i).find("input[type=checkbox]:checked").removeAttr("checked"),o("[name^='gcmi-com-cod-pro-"+i).hide()):(o("[name^='gcmi-com-cod-pro-"+i).show(),o("[name^='gcmi-com-cod-pro-"+i).find("input[type=checkbox]:not(:checked)").prop("checked",!0)),t(),o("[id='gcmi-fb-regione-blocco-"+c).find("input[type=checkbox][id^=fb-gcmi-prov-]:checked").length===o("[id='gcmi-fb-regione-blocco-"+c).find("input[type=checkbox][id^=fb-gcmi-prov-]").length&&o("[id='fb-gcmi-chkallpr-"+c).prop("checked",!0)}),o(document).on("change","input[type='checkbox'][id^='fb-gcmi-com-']",function(){var e=Array.from(o("label[for='"+this.name+"']").text())[0];o("[id='fb-gcmi-chkallcom-"+e).removeAttr("checked"),o("[id='gcmi-fb-lettera-blocco-"+e).find("input[type=checkbox][id^=fb-gcmi-com-]:visible:checked").length===o("[id='gcmi-fb-lettera-blocco-"+e).find("input[type=checkbox][id^=fb-gcmi-com-]:visible").length&&o("[id='fb-gcmi-chkallcom-"+e).prop("checked",!0)}),o(document).on("change","input[type='checkbox'][id^='fb-gcmi-chkallpr-']",function(){var e=o(this),i=o(this).attr("id").split("-").pop();!1===e.prop("checked")?o("#gcmi-fb-regione-blocco-"+i).find("input[type=checkbox]:checked").not("[id^='fb-gcmi-chkallpr-']").removeAttr("checked"):o("#gcmi-fb-regione-blocco-"+i).find("input[type=checkbox]:not(:checked)").not("[id^='fb-gcmi-chkallpr-']").prop("checked",!0),o("#gcmi-fb-regione-blocco-"+i).find("input[type=checkbox]").not("[id^='fb-gcmi-chkallpr-']").trigger("change")}),o(document).on("change","input[type='checkbox'][id^='fb-gcmi-chkallcom-']",function(){var e=o(this),i=o(this).attr("id").split("-").pop();!1===e.prop("checked")?o("#gcmi-fb-lettera-blocco-"+i).find("input[type=checkbox]:checked:visible").not("[id^='fb-gcmi-chkallcom-']").removeAttr("checked"):o("#gcmi-fb-lettera-blocco-"+i).find("input[type=checkbox]:not(:checked):visible").not("[id^='fb-gcmi-chkallcom-']").prop("checked",!0)}),o(document).on("change","input[type='checkbox'][id='gcmi-fb-include-ceased']",function(){var i=o("#fb_gcmi_filter_name").val(),c="tmp_"+(new Date).getTime(),e=o("#gcmi-fb-include-ceased").prop("checked"),t=(event.preventDefault(),o("#gcmi-fb-tabs-4").find("input[type=checkbox]:checked").not("[id^='fb-gcmi-chkallcom-']").map(function(){return o(this).val()}).get());n(),f(),o.ajax({type:"post",dataType:"json",url:gcmi_fb_obj.ajax_url,data:{action:"gcmi_fb_create_filter",_ajax_nonce:gcmi_fb_obj.nonce,includi:e,filtername:c,codici:t},success:function(e){d(c),o.ajax({type:"post",dataType:"json",url:gcmi_fb_obj.ajax_url,data:{action:"gcmi_fb_delete_filter",_ajax_nonce:gcmi_fb_obj.nonce,filtername:c},error:function(e){console.log(e)}}),o("#fb_gcmi_filter_name").val(i)},error:function(e){console.log("Fallita creazione filtro temporaneo"),p()}})})});